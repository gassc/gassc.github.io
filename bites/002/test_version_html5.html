<!DOCTYPE html>

<html>
<head>
	<meta charset=utf-8 />
	<title>SAVID</title>
	<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
	<!--Mapbox-->
	<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.6/mapbox.js'></script>
	<link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.6/mapbox.css' rel='stylesheet' />
	<style>
		body {
			margin:0;
			padding:0;
			}
		div#map {
			width:550px;
			height:300px;
			margin:0px auto;
			}
		div#video_player_box{
			width:550px; background:#000; margin:0px auto;
			}
		div#video_controls_bar{
			background: #333; padding:10px; color:#CCC;
			}
		
	</style>
	
	<script src='GOPR5268.mp4.js'></script>
	
	<script>
		var vid, playbtn, seekslider, curtimetext, durtimetext;
		function intializePlayer(){
			// Set object references
			vid = document.getElementById("my_video");
			playbtn = document.getElementById("playpausebtn");
			seekslider = document.getElementById("seekslider");
			curtimetext = document.getElementById("curtimetext");
			durtimetext = document.getElementById("durtimetext");
			// Add event listeners
			playbtn.addEventListener("click",playPause,false);
			seekslider.addEventListener("change",vidSeek,false);
			vid.addEventListener("timeupdate",seektimeupdate,false);
			}

		window.onload = intializePlayer;
		
		//play/pause button
		function playPause(){
			if(vid.paused){
				vid.play();
				playbtn.innerHTML = "Pause";
				}
			else {
				vid.pause();
				playbtn.innerHTML = "Play";
				}
			}
		
		//seek-slider
		function vidSeek(){
			var seekto = vid.duration * (seekslider.value / 100);
			vid.currentTime = seekto;
			}
		function seektimeupdate(){
			var nt = vid.currentTime * (100 / vid.duration);
			seekslider.value = nt;
			var curmins = Math.floor(vid.currentTime / 60);
			var cursecs = Math.floor(vid.currentTime - curmins * 60);
			var durmins = Math.floor(vid.duration / 60);
			var dursecs = Math.floor(vid.duration - durmins * 60);
			if(cursecs < 10){ cursecs = "0"+cursecs; }
			if(dursecs < 10){ dursecs = "0"+dursecs; }
			if(curmins < 10){ curmins = "0"+curmins; }
			if(durmins < 10){ durmins = "0"+durmins; }
			curtimetext.innerHTML = curmins+":"+cursecs;
			durtimetext.innerHTML = durmins+":"+dursecs;
			}

		////////////////////////////
		// Mapbox Map
		
		// MapBox access token
		L.mapbox.accessToken = 'pk.eyJ1IjoiY2JndGhvcjYyNCIsImEiOiJzZ2NaNmo4In0.hbXzZPAvaCO5GLu45bptTw';
		// Create a map in the div #map
		var map = L.mapbox.map('map', 'cbgthor624.hnc4bbke',{
				closePopupOnClick:false})
				.setView([40.144725, -79.278184,], 17);	
		
		// create feature style
		function style(feature) {
			return {
				weight: 7,
				opacity: 0.5,
				color: 'red'
			};
		}
		
		// add 'fly' data as geojson
		var line = L.geoJson(fly, {
			style: style
		}).addTo(map);
		
		// create marker *at starting point of geojson*
		var marker = L.marker([0,0], {
				icon: L.mapbox.marker.icon({
						type: 'Feature',
						geometry: {
								type: 'Point',
								coordinates: [-79.278184,40.144725]
						},
						properties: {
							'marker-color': 'gray',
						}
				})
		}).addTo(map)
		
	
		// access the line's coordinate list
		var coords = fly.features[0].geometry.coordinates,
			i = 0;
		
		//function that moves the marker by setting its placement on each point in the list of coordinates
		function tick() {
			marker.setLatLng([coords[i][1], coords[i][0]]);
		
			// ensure the marker doesn't fall off the end of 
			// the list of coordinates.
			// 1000ms is the time interval between points
			if (++i < coords.length) setTimeout(tick, 1000);
		}
		
		// start the animation
		tick();
			
	</script>
	
</head>


<body>
	
	<div id="video_player_box">
		<video id="my_video" width="550" autoplay>
			<source src="GOPR5268.mp4" type="video/mp4">
			<p>Your browser does not support HTML5 video.</p>
		</video>
		<div id='map' class="dark"></div>
		<div id="video_controls_bar">
			<button id="playpausebtn">Pause</button>
			<input id="seekslider" type="range" min="0" max="100" value="0" step="1">
			<span id="curtimetext">00:00</span> / <span id="durtimetext">00:00</span>
		</div>
	</div>
	


	<script>
	
	/*
	////////////////////////////
	// Youtube Video
	// test @ https://www.youtube.com/watch?v=sqJDypl-2os
	
	// This code loads the IFrame Player API code asynchronously.
	var tag = document.createElement('script');

	tag.src = "https://www.youtube.com/iframe_api";
	var firstScriptTag = document.getElementsByTagName('script')[0];
	firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

	// This function creates an <iframe> (and YouTube player)
	// after the API code downloads.
	var player;
	function onYouTubeIframeAPIReady() {
		player = new YT.Player('player', {
			height: '390',
			width: '640',
			videoId: 'sqJDypl-2os',
			events: {
				'onReady': onPlayerReady,
				'onStateChange': onPlayerStateChange
			}
		});
	}

	// The API will call this function when the video player is ready.
	function onPlayerReady(event) {
		event.target.playVideo();
	}

	// The API calls this function when the player's state changes.
	// The function indicates that when playing a video (state=1),
	// the player should play for six seconds and then stop.
	var done = false;
	function onPlayerStateChange(event) {
		if (event.data == YT.PlayerState.PLAYING && !done) {
			setTimeout(stopVideo, 632000);
			done = true;
		}
	}
	function stopVideo() {
		player.stopVideo();
	}
	*/
	</script>

</body>
</html>
